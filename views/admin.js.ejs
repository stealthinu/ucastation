// WebSocketでの通信部分
var port = '<%= port %>';
var password = 'pass';

var socket = io.connect( "/admin", { port: port } );

socket.emit( 'admin login', password, function( reply ) {
  console.log( "admin login reply:" + reply );
  if ( reply == "OK admin login" ) {
    $("#condition").html( "admin login" );
  }
});


socket.on( 'connect', function() {
  console.log( "connect." );
});

socket.on( 'disconnect', function() {
  console.log( "disconnect." );
  $("#condition").html( "------" );
});

socket.on( 'view num', function( num ) {
  $("#view_num").html( num );
});

function sendChannel( channel ) {
  $("#condition").html( "channel sending..." );
  socket.emit( 'admin channel', channel, function( reply ) {
    console.log( "admin channel reply:" + reply );
    if ( reply == "OK admin channel" ) {
      $("#condition").html( "channel send OK" );
    }
  });
}

function sendBoard( text ) {
  text = text.replace(/(\r\n|\n|\r)/g, '<br>'); // 改行を<br>に置き換え

  $("#condition").html( "board sending..." );
  socket.emit( 'admin board', text, function( reply ) {
    console.log( "admin board reply:" + reply );
    if ( reply == "OK admin board" ) {
      $("#condition").html( "board send OK" );
    }
  });
}
