// WebSocketでの通信部分
var port = '<%= port %>';
var password = 'pass';
var socket = new io.Socket( null, { port: port } );
socket.connect();

socket.on( 'connect', function() {
  console.log( "connect." );
});

socket.send( 'admin ' + password );

function sendChannel( channel ) {
  socket.send( channel );
}


// Ustの表示部分
var autoplay_flag = 'true';
var height = '386';
var width = '480';
var key = '<%= key %>';
var ust_api = 'http://api.ustream.tv/json/channel/';
var command = 'getCustomEmbedTag';

function displayUst( channel, target ) {
  var option = 'params=autoplay:' + autoplay_flag + ';mute:false;height:' + height + ';width:' + width;
  var api = ust_api + encodeURIComponent( channel ) + '/' + command + '?' + option + '&key=' + key + '&callback=?';
  $.getJSON( api, function( embedTag ) {
    $('#' + target).html( embedTag );
  });
}
